(()=>{"use strict";const e=document.querySelectorAll(".dot"),t=document.querySelector(".slider_img"),n=[{src:"../../assets/banner_first.png"},{src:"../../assets/banner_second.png"},{src:"../../assets/banner_third.png"}],s=()=>JSON.parse(localStorage.getItem("cartItems"))||[],a=e=>{const t=document.querySelector(".cart_counter");t.textContent=e,t.style.display=e>0?"block":"none"};let o=s()||[];const c=document.querySelectorAll(".categories_link"),r=document.querySelector(".cards_block"),i=new URLSearchParams({});let d=0;async function l(e){try{let t=`https://www.googleapis.com/books/v1/volumes?q=subject:${document.querySelector(".categories_link.active").dataset.category}&${i.toString()}`;const n=await fetch(t);if(!n.ok)throw new Error(`${n.status}`);const s=await n.json();e&&e(s.items)}catch(e){console.error("Ошибка!",e)}}i.append("key","AIzaSyBfjVWmSbeEwt2vNv9Sot1czhDFxchs3GM"),i.append("printType","books"),i.append("startIndex",d),i.append("maxResults","6"),i.append("langRestrict","en");const u=e=>{let t=" ",n="",s="",a="",c="",i="",d="";e.forEach((e=>{console.log(e.id),n=e.volumeInfo.authors?e.volumeInfo.authors.join(", "):"Unknown",s=e.volumeInfo.imageLinks.thumbnail||"",t=e.volumeInfo.title||"Unknown",d=e.volumeInfo.description||"No description",a=e.saleInfo.retailPrice?e.saleInfo.retailPrice.amount+" "+e.saleInfo.retailPrice.currencyCode:"Unavailable",i=e.volumeInfo.averageRating?e.volumeInfo.ratingsCount:" ",c=e.volumeInfo.averageRating||0,c=Math.round(c);let l="";for(let e=1;e<=5;e++)l+=e<=c?'<img src="../../assets/star_active.svg" alt="" class="raiting_star">':'<img src="../../assets/star.svg" alt="" class="raiting_star">';const u=document.createElement("div");u.classList.add("cards_item"),u.innerHTML=`<img src = ${s} alt="book cover" class="card_img">\n\n                <div class="card_info">\n                    <div class="info_author">${n}</div>\n                    <div class="info_title">${t}</div>\n                    <div class="info_raiting">\n                        <div>${l}</div>\n                        ${i} review</div>\n                    <p class="info_text">${d}</p>\n                    <div class="info_cost">${a}</div>\n                    <button class="info_btn ${o.includes(e.id)?"added":""}" data-book-id="${e.id}">\n                        ${o.includes(e.id)?"in the cart":"buy now"}\n                    </button>\n                </div>`,r.appendChild(u)}))},v=document.querySelector(".cart_counter");let m=s()||[],f=m.length;a(f);const g=e=>{if(e.target.classList.contains("info_btn")){const n=e.target,s=n.dataset.bookId;if(n.classList.contains("added")){const e=m.indexOf(s);e>-1&&(m.splice(e,1),f--,n.textContent="Buy now",n.classList.remove("added"))}else m.push(s),f++,n.textContent="In the cart",n.classList.add("added"),v.style.display="block";t=m,localStorage.setItem("cartItems",JSON.stringify(t)),a(f)}var t};document.addEventListener("DOMContentLoaded",(()=>{document.querySelectorAll(".info_btn").forEach((e=>{const t=e.dataset.bookId;m.includes(t)?(e.textContent="In the cart",e.classList.add("added")):e.textContent="Buy now"})),document.addEventListener("click",g)}));const p=document.querySelector(".dots"),h=document.querySelectorAll(".categories_link"),y=document.querySelector(".load_btn"),L=document.querySelectorAll(".nav_link");L.forEach((e=>{e.addEventListener("click",(()=>{var t;t=e,L.forEach((e=>e.classList.remove("active"))),t.classList.add("active")}))})),document.addEventListener("DOMContentLoaded",void setInterval((()=>{let s=+document.querySelector(".dot.active").dataset.id-1;var a;a=s===n.length-1?0:s+1,t.src=n[a].src,e.forEach((e=>e.classList.remove("active"))),e[a].classList.add("active")}),5e3)),p.addEventListener("click",(s=>{const a=s.target.dataset.id;a&&(s=>{t.src=n[s-1].src,e.forEach((e=>e.classList.remove("active"))),e[s-1].classList.add("active")})(+a)})),h.forEach((e=>{e.addEventListener("click",(t=>{var n;n=e,c.forEach((e=>e.classList.remove("active"))),n.classList.add("active"),r.innerHTML="",i.set("startIndex","0"),l(u),t.preventDefault()}))})),l(u),y.addEventListener("click",(()=>{d+=6,i.set("startIndex",d),l(u)})),document.addEventListener("click",(e=>{g(e)}))})();